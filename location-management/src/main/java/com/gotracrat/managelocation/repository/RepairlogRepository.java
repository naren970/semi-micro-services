/*
 * Created on 2018-11-29 ( Date ISO 2018-11-29 - Time 19:27:59 )
 * Generated by Prabhakar
*/
package com.gotracrat.managelocation.repository;

import java.util.List;

import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.JpaSpecificationExecutor;
import org.springframework.data.jpa.repository.Modifying;
import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.query.Param;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import com.gotracrat.managelocation.entity.Repairlog;

/**
 * Jpa repository for Repairlog.
 * 
 * @author Prabhakar
 */
@Repository
public interface RepairlogRepository extends JpaRepository<Repairlog, Integer>, JpaSpecificationExecutor<Repairlog> {
	public List<Repairlog> findByItemidAndComplete(Integer itemId, boolean completedFlag);
	
	@Query(value = "SELECT * FROM RepairLog WHERE ItemId = :itemId AND Complete=:Complete AND Is_Active=1 ORDER BY ACTUALCOMPLETION DESC", nativeQuery = true)
    List<Repairlog> findRepairLogByItemidAndIsActive(@Param("itemId") Integer itemId,@Param("Complete") Boolean completedFlag);
	
	@Modifying(clearAutomatically = true)
	 @Transactional
	 @Query(value ="update RepairLog set Is_Active = 0 where repairLogid =:repairLogId", nativeQuery = true)
	public void deleteRepair(@Param("repairLogId") Integer repairLogId);
	@Query(value ="SELECT * FROM RepairLog WHERE RepairLogId = :repairLogId AND Is_Active=1", nativeQuery = true)
	Repairlog findByRepairLogId(@Param("repairLogId") Integer repairlogid);
}